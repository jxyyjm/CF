            user_id        item_id         rating     timestamp
count  100000.00000  100000.000000  100000.000000  1.000000e+05
mean      462.48475     425.530130       3.529860  8.835289e+08
std       266.61442     330.798356       1.125674  5.343856e+06
min         1.00000       1.000000       1.000000  8.747247e+08
25%       254.00000     175.000000       3.000000  8.794487e+08
50%       447.00000     322.000000       4.000000  8.828269e+08
75%       682.00000     631.000000       4.000000  8.882600e+08
max       943.00000    1682.000000       5.000000  8.932866e+08
Index([u'user_id', u'item_id', u'rating', u'timestamp'], dtype='object')
Number of users = 943 | Number of movies = 1682
<type 'numpy.ndarray'> (943, 943) user_similarity
<type 'numpy.ndarray'> (1682, 1682) item_similarity
[[  1.11022302e-16   8.83367497e-01   9.58843620e-01 ...,   8.87971421e-01
    8.57777509e-01   7.30224412e-01]
 [  8.83367497e-01  -2.22044605e-16   9.30896165e-01 ...,   9.04943019e-01
    8.81761202e-01   8.96013046e-01]
 [  9.58843620e-01   9.30896165e-01   1.11022302e-16 ...,   1.00000000e+00
    9.16389745e-01   9.79098499e-01]
 ..., 
 [  6.56696562e-01   8.77466643e-01   9.89224659e-01 ...,   9.41671871e-01
    7.85662644e-01   7.64604390e-01]
 [  9.34004827e-01   9.19936724e-01   9.45492084e-01 ...,   8.76075863e-01
    9.55050247e-01   9.41900290e-01]
 [  7.34942377e-01   9.25032292e-01   9.34074884e-01 ...,   9.40706329e-01
    8.61616603e-01   8.85098201e-01]]
[[  1.11022302e-16   6.95796838e-01   7.38683745e-01 ...,   1.00000000e+00
    9.45313126e-01   1.00000000e+00]
 [  6.95796838e-01  -2.22044605e-16   8.18853092e-01 ...,   1.00000000e+00
    9.07417990e-01   9.07417990e-01]
 [  7.38683745e-01   8.18853092e-01   0.00000000e+00 ...,   1.00000000e+00
    1.00000000e+00   8.89940674e-01]
 ..., 
 [  9.65412984e-01   8.92650992e-01   9.14924008e-01 ...,   1.00000000e+00
    1.00000000e+00   1.00000000e+00]
 [  8.52823639e-01   9.74444937e-01   9.16457035e-01 ...,   1.00000000e+00
    1.00000000e+00   1.00000000e+00]
 [  8.04221302e-01   9.47304444e-01   8.69018675e-01 ...,   1.00000000e+00
    1.00000000e+00   1.00000000e+00]]
========= after predict =========
<type 'numpy.ndarray'> (943, 1682) user_prediction
<type 'numpy.ndarray'> (943, 1682) item_prediction
[[ 1.53583322  0.52661763  0.45487972 ...,  0.26321327  0.26320133
   0.26313051]
 [ 1.27778482  0.25542081  0.14372055 ..., -0.06985931 -0.06865815
  -0.06852976]
 [ 1.31920948  0.22597514  0.12234332 ..., -0.10130791 -0.09959954
  -0.09943959]
 ..., 
 [ 1.277513    0.22399639  0.1505891  ..., -0.05921379 -0.05895238
  -0.05874647]
 [ 1.26086262  0.19959581  0.1030884  ..., -0.11494232 -0.11372155
  -0.11372521]
 [ 1.52140078  0.48131684  0.40543318 ...,  0.19486545  0.19518541
   0.19528257]]
[[ 0.33903953  0.35527025  0.37023434 ...,  0.41539016  0.40656096
   0.40441981]
 [ 0.08092463  0.09479235  0.08961839 ...,  0.09420523  0.09579132
   0.09606085]
 [ 0.06565237  0.069014    0.06588911 ...,  0.06399353  0.067051
   0.06791486]
 ..., 
 [ 0.07777685  0.07914884  0.0885333  ...,  0.09853168  0.09494721
   0.09578781]
 [ 0.04264041  0.04593589  0.04669439 ...,  0.04823277  0.04911561
   0.04936937]
 [ 0.29382128  0.31337549  0.32817014 ...,  0.34780245  0.3427364
   0.34266247]]
User-based CF RMSE: 3.11861787032
Item-based CF RMSE: 3.4444599513
            user_id        item_id         rating     timestamp
count  100000.00000  100000.000000  100000.000000  1.000000e+05
mean      462.48475     425.530130       3.529860  8.835289e+08
std       266.61442     330.798356       1.125674  5.343856e+06
min         1.00000       1.000000       1.000000  8.747247e+08
25%       254.00000     175.000000       3.000000  8.794487e+08
50%       447.00000     322.000000       4.000000  8.828269e+08
75%       682.00000     631.000000       4.000000  8.882600e+08
max       943.00000    1682.000000       5.000000  8.932866e+08
Index([u'user_id', u'item_id', u'rating', u'timestamp'], dtype='object')
Number of users = 943 | Number of movies = 1682
The sparsity level of Movielens100k is 93.7
(943, 20) 	u.shape			<type 'numpy.ndarray'>
(20,) 		s.shape			<type 'numpy.ndarray'>
(20, 20) 	s_diag_matrix.shape	<type 'numpy.ndarray'>
(20, 1682) 	vt.shape		<type 'numpy.ndarray'>
(943, 1682) 	x_pred.shape		<type 'numpy.ndarray'>
(943, 1682) 	train_data_matrix	<type 'numpy.ndarray'>
[[ 1.73507128  0.99249003  1.12257976  2.80305131  0.60348002  0.399832
   3.29098518  2.61354104  3.20735222  1.24966401]
 [ 1.9410321  -0.2288042   0.17525227  0.26062217 -0.01433291  0.11767499
   1.79019946  0.48935416  1.91302734  0.42298312]]
[[ 0.  0.  4.  3.  3.  5.  4.  0.  5.  3.]
 [ 4.  0.  0.  0.  0.  0.  0.  0.  0.  2.]]
(943, 20) 	user_train_matrix	<type 'numpy.ndarray'>
(20, 1682) 	item_train_matrix	<type 'numpy.ndarray'>
(943, 943) 	user_similarity	<type 'numpy.ndarray'>
(1682, 1682) 	item_similarity	<type 'numpy.ndarray'>
========= after predict =========
<type 'numpy.ndarray'> (943, 1682) user_prediction
<type 'numpy.ndarray'> (943, 1682) item_prediction
[[ 1.61671282  0.5582263   0.48230772 ...,  0.30289437  0.30018715
   0.30018715]
 [ 1.34370062  0.31102295  0.14843836 ..., -0.09345502 -0.09512701
  -0.09512701]
 [ 1.5703818   0.25030139  0.13232985 ..., -0.13482594 -0.13505059
  -0.13505059]
 ..., 
 [ 1.28151288  0.20676008  0.15551555 ..., -0.07300188 -0.07537789
  -0.07537789]
 [ 1.26671949  0.2313102   0.11187606 ..., -0.12929899 -0.13137678
  -0.13137678]
 [ 1.60015454  0.51540905  0.4280444  ...,  0.20226097  0.19958366
   0.19958366]]
[[ 0.3888427   0.42072437  0.39634311 ...,  0.48779171  0.4470868
   0.4470868 ]
 [ 0.07186444  0.10475642  0.08981934 ...,  0.07821075  0.09155767
   0.09155767]
 [ 0.05613068  0.05766611  0.05402372 ...,  0.02224293  0.0529132
   0.0529132 ]
 ..., 
 [ 0.07168303  0.07352333  0.08831518 ...,  0.09121729  0.08977408
   0.08977408]
 [ 0.03709542  0.04631517  0.04566678 ...,  0.04214886  0.04399524
   0.04399524]
 [ 0.3213914   0.38029142  0.3573241  ...,  0.3873033   0.35434007
   0.35434007]]
User-based CF RMSE: 3.13576289243
Item-based CF RMSE: 3.44994849201
